<div class="job-details-card">
  <div class="header-row">
    <h2>Job Details</h2>
    <button mat-icon-button class="close-button" (click)="dialogRef.close()">
      <span>&times;</span>
    </button>
  </div>
  <div class="job-info-grid">
    <div><strong>Title:</strong> {{ jobDetails.title || 'Loading...' }}</div>
    <div><strong>Client:</strong> {{ jobDetails.clientName || 'Loading...' }}</div>
    <div><strong>Price:</strong> Rs. {{ jobDetails.price ? (jobDetails.price | number:'1.2-2') : 'Loading...' }}</div>
    <div><strong>Requested Date:</strong> {{ jobDetails.requestedDate ? (jobDetails.requestedDate | date:'mediumDate') : 'Loading...' }}</div>
    <div><strong>Address:</strong> {{ jobDetails.address || 'Loading...' }}</div>
    <div><strong>Description:</strong> {{ jobDetails.description || 'Loading...' }}</div>
    <div><strong>Tags:</strong> {{ jobDetails.tags || 'Loading...' }}</div>
  </div>
</div>

<div class="status-tracker">
  <div
    class="step"
    *ngFor="let step of steps; let i = index"
    [class.active]="i <= currentStep && step !== 'Rejected'"
    [class.rejected]="step === 'Rejected' && i === currentStep">
    <div class="circle">{{ i + 1 }}</div>
    <div class="label">{{ step }}</div>
  </div>
</div>

<div class="status-controls">
  <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="currentStep >= steps.length - 1">
    Next Status
  </button>
  <button mat-raised-button color="warn" (click)="rejectJob()" [disabled]="currentStep !== 0">
    Reject Job
  </button>
</div>


<div class="status-log-card">
  <h3>Status Log</h3>
  <table>
    <thead>
    <tr>
      <th>Date & Time</th>
      <th>Updated By</th>
      <th>Status</th>
      <th>Remarks</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let log of statusLogs">
      <td>{{ log.date | date: 'short' }}</td>
      <td>{{ log.updatedBy }}</td>
      <td>{{ log.status }}</td>
      <td>{{ log.note }}</td>
    </tr>
    </tbody>
  </table>
</div>
